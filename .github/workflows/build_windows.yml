name: üì¶ Build PlantHub Windows EXE

on:
  # O build ser√° executado quando houver um push para a branch principal
  push:
    branches:
      - main
  # Permite executar o workflow manualmente
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: "3.10" # Vers√£o est√°vel

      - name: Install dependencies
        run: pip install flet pyinstaller

      # CR√çTICO: Rodar o flet pack com os assets e √≠cone
      - name: Run Flet Pack and Build EXE
        run: |
          # O PyInstaller usa o PowerShell no Windows. 
          # O acento grave (`) √© o caractere de continua√ß√£o de linha no PowerShell.
          flet pack main.py --name PlantHub --onefile `
          --icon "assets/planthub_icon.ico" `
          --add-data "assets;assets"

      - name: üìÅ Upload Executable to Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: PlantHub-Windows-EXE
          path: dist/PlantHub.exe
          retention-days: 7 # Mant√©m o execut√°vel dispon√≠vel por 7 dias
